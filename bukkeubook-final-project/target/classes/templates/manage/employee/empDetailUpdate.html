<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
     xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
  <head>
     <title>사원 정보 수정</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="../css/style.css">
      
<link rel="stylesheet"  th:href="@{/css/mypage/youchan.css}">
      <link th:href="@{/css/manage/employee/HR.css}" rel="stylesheet">
      <link th:href="@{/css/manage/employee/Listdetail.css}" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  </head>
<body>
   <div th:replace="/common/topSideBar.html"></div>
   <h2 class="mb-4" id="main-text">사원관리</h2>
        <hr><br><br>
        <h5 class="mb-4" id="sub-text">사원 정보 수정</h5>
        <br>
         <form action="/manage/empDetailUpdate" method="post" id="updateForm"> 
          <div class="emp detail list"> 
           <table border="2">
            <thead>
              <tr class="detailtitle">
                <th colspan="4">사원 정보 수정</th>
              </tr>
            </thead>
            <tbody>
              <tr class="deemp2">
                <td>사원번호</td>
                <td colspan="3">
                <input type="text" th:value="${ emp.empNo }" name="empNo" readonly style="border:none;">
                </td>
              </tr>
              <tr class="deemp2">
                <td>사원명</td>
                <td colspan="3">
                   <input type="text" th:value="${ emp.empName }" name="empName" maxlength="5">
                </td>
              </tr>
               <tr class="deemp2">
                <td>부서명</td>
                <td colspan="3">
                본 부서코드 : <input type="text" name="deptCode" th:value="${ emp.deptCode }" readonly style="width:70px;">
                변경 : 
                 <select class="sel3" name="deptCode2" >
                  <option value="">None</option>
                  <option value="1">임원</option>
                  <option value="2">재무부</option>
                  <option value="3">인사부</option>
                  <option value="4">총무부</option>
                  <option value="5">도서물류부</option>
                </select> 
                </td>
              </tr>
              <tr class="deemp2">
                <td>직급</td>
                <td colspan="3">
                   본 직급 : <input type="text" name="empJobCode" th:value="${ emp.empJobCode }" readonly style="width:70px;">
                   변경 : 
                   <select class="sel3" name="empJobCode2">
                    <option value="">None</option>
                    <option value="사장">사장</option>
                    <option value="부장">부장</option>
                    <option value="팀장">팀장</option>
                    <option value="대리">대리</option>
                    <option value="사원">사원</option>
                  </select> 
                </td>
              </tr>
              <tr class="deemp2" >
                <td>입사일자</td>
                <td colspan="3">
                <input type="text" th:value="${ emp.empEntDate }" name="empEntDate" readonly style="border:none;">
                </td>
              </tr>
              <tr class="deemp2">
                <td>퇴사여부</td>
                <td colspan="3"><input type="text" th:value="${ emp.empEndYn }" name="empEndYn" readonly style="border:none;"></td>
              </tr>
              <tr class="deemp" >
                <td>성별</td>
                <td colspan="3">
                   <input type="text" th:value="${ emp.empGender }" name="empGender" readonly style="border:none;">
                </td>
              </tr>
              <tr class="deemp" >
                <td>생년월일</td>
             <td colspan="3"><input type="text" th:value="${ emp.empBirth }" readonly style="border:none;">
              </tr>
              <tr class="deemp" >
                <td>연락처</td>
           	    <td><input type="text" th:value="${ emp.empPhone1 }" name="empPhone1" maxlength="3" id="empPhone1"></td>
                <td><input type="text" th:value="${ emp.empPhone2 }" name="empPhone2" maxlength="4" id="empPhone2"></td>
                <td><input type="text" th:value="${ emp.empPhone3 }" name="empPhone3" maxlength="4" id="empPhone3"></td>
              </tr>
              <tr class="deemp">
                <td>이메일</td>
                <td colspan="3"><input type="text" th:value="${ emp.empEmail }" name="empEmail" maxlength="30"></td>
              </tr>
              <tr class="deemp" >
                <td>우편번호</td>
                <td colspan="3">
                  <input type="text" id="zipCode" th:value="${ emp.empAddress }" name="empAddress">
                  <input type="button" value="검색" class="input2" id="searchZipCode">
                </td>  
              </tr>
              <tr class="deemp" >
                <td>상세주소</td>
                <td colspan="3"><input type="text" th:value="${ emp.empDAddress }" name="empDAddress" id="address1"></td>
              </tr>
             <tr class="deemp" >
                <td>연봉</td>
                <td colspan="3"><input type="number" th:value="${ emp.empTotalSal }" name="empTotalSal" maxlength="10"></td>
              </tr>
            </tbody>
          </table><br>
          
          <div id="space">
          	<input type="button" id="updateBtn" class="modify btn" value="수정완료"></input>
          	<button type="button" class="list btn backBtn" style="margin-right: 0px;">목록으로</button>
          	<!-- 직원 퇴사처리 --> 
	        
          </div>
         </div>
        </form>
        <form action="/manage/empLeave" method="post" id="leaveform">
	          <input type="hidden" th:value="${ emp.empNo }" name="empNo" readonly style="border:none;">
	          <input type="button" id="leavebtn" class="modify btn" value="퇴사처리" style="background: red; color: white;">
        </form>
        <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
  		<div>
        <div class="inline">
        <div class="container mt-3 leftMar20" style="margin-left:330px;">
            <div class="card" style="width:400px">
             <img class="card-img-top" th:src="@{/images/mypage/{imageFile}(imageFile=${profile[0].photoSavedName})}" alt="Card image" style="width:50%; height: 250px; margin-left: 25%;">
              <div class="card-body">
                <h4 class="card-title" style="text-align: center;">Profile</h4>
                <form action="/manage/detailUpdate2" method="post" encType="multipart/form-data" id="proform">
                <input id="test2" type="hidden" name="empNo" value="">
                <input type="file" name="singleFile" style="margin-left: 25%;" id="proInput" required>
                <input type="button" id="probtn" class="btn btn-primary" value="수정하기" style="margin-left: 25%; margin-top:10px;">
                </form>
              </div>
            </div>
        </div>
        </div>
        <!--  서명 수정 부분 -->
        <div class="inline">
            <div class="container mt-3 ">
                <div class="card" style="width:400px">
                  <img class="card-img-top" th:src="@{/images/sign/{signFile}(signFile=${mySign.signSavedName})}" alt="Card image" style="width:50%; height: 250px; margin-left: 25%;">
                  <div class="card-body">
                    <h4 class="card-title" style="text-align: center;">Sign</h4>
                       <form action="/manage/detailUpdate23" method="post" id="nameform" encType="multipart/form-data">
                         <input id="test1" type="hidden" name="empNo" value="">
                         <input type="file" name="singleFile" style="margin-left: 25%;" id="nameInput" required>
                         <input type="button" id="namebtn" class="btn btn-primary" value="수정하기" style="margin-left: 25%; margin-top:10px;">
                      </form>
                  </div>
                </div>
            </div>
      	  <br><br><br><br><br><br>
         </div>
       </div> 
       
     <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
      <script>
         const searchZipCode = document.getElementById("searchZipCode");
         
         searchZipCode.onclick = function() {
         
            new daum.Postcode({
               oncomplete: function(data){
                  document.getElementById("zipCode").value = data.zonecode;
                  document.getElementById("address1").value = data.address;
   
               }
            }).open();
         }
	
         $().ready(function () {
             $(".updateBtn").click(function () {
                 Swal.fire({
                     title: '수정 하시겠습니까?',
                     icon: 'warning',
                     showCancelButton: true,
                     confirmButtonColor: '#3085d6',
                     cancelButtonColor: '#d33',
                     confirmButtonText: '승인',
                     cancelButtonText: '취소'
                 }).then((result) => {
                	 location.href="/manage/empDetailUpdate";
					
                 })
             });
         });
         
        $("#probtn").click(function(){
            Swal.fire({
                  title: '프로필 사진을 변경 하시겠습니까?',
                  text: "변경한 프로필 사진으로 회원 정보에 등록됩니다.",
                  icon: 'question',
                  showCancelButton: true,
                  confirmButtonColor: '#3085d6',
                  cancelButtonColor: '#d33',
                  confirmButtonText: '승인',
                  cancelButtonText: '취소'
              }).then((result) => {
                  if (result.isConfirmed) {
                     if($('#proInput').val() !== ""){
                        $("#proform").submit();
                     }else{
                        Swal.fire({
                            icon: 'error',                        
                            title: '잘못된 값이 입력되었습니다.',         
                            text: '파일이 정상적으로 들어있는지 확인해주세요',  
                        });
                     }
                  }
              })
        });
        
          $("#namebtn").click(function(){
            Swal.fire({
                  title: '도장(서명)을 변경 하시겠습니까?',
                  text: "변경한 도장(서명)으로 회원 정보에 등록됩니다.",
                  icon: 'question',
                  showCancelButton: true,
                  confirmButtonColor: '#3085d6',
                  cancelButtonColor: '#d33',
                  confirmButtonText: '승인',
                  cancelButtonText: '취소'
              }).then((result) => {
                  if (result.isConfirmed) {
                     if($('#nameInput').val() !== ""){
                        $("#nameform").submit();
                     }else{
                        Swal.fire({
                            icon: 'error',                        
                            title: '잘못된 값이 입력되었습니다.',         
                            text: '파일이 정상적으로 들어있는지 확인해주세요',  
                        });
                     }
                  }
              })
         });

   	</script>
		
   <script th:inline="javascript">      
        $("#update").click(function () {
        	let nameFile = $("#nameFile").val();       	
        	console.log(nameFile);
        	$("#updateForm").submit();
        });
        
        $().ready(function () {
         $(".backBtn").click(function () {
             Swal.fire({
                 title: '작성내용이 모두 사라집니다.',
                 text: "진행 하시겠습니까?",
                 icon: 'warning',
                 showCancelButton: true,
                 confirmButtonColor: '#c5bfbf',
                 cancelButtonColor: '#c5bfbf',
                 confirmButtonText: '확인',
                 cancelButtonText: '취소'
             }).then((result) => {
                 if (result.isConfirmed) {
                     window.history.back();
                 }
             })
         });
     });
			
        $("#leavebtn").click(function(){
            Swal.fire({
                  title: '퇴사를 진행 하시겠습니까?',
                  text: "현재 사원을 퇴사 사원으로 변경 합니다.",
                  icon: 'question',
                  showCancelButton: true,
                  confirmButtonColor: '#3085d6',
                  cancelButtonColor: '#d33',
                  confirmButtonText: '승인',
                  cancelButtonText: '취소'
              }).then((result) => {
                  if (result.isConfirmed) {
                      $('#leaveform').submit();
                  }
              })
        });
        $("#updateBtn").click(function(){
            Swal.fire({
                  title: '정보수정을 진행 하시겠습니까?',
                  text: "현재 사원의 정보를 변경 합니다.",
                  icon: 'question',
                  showCancelButton: true,
                  confirmButtonColor: '#3085d6',
                  cancelButtonColor: '#d33',
                  confirmButtonText: '승인',
                  cancelButtonText: '취소'
              }).then((result) => {
                  if (result.isConfirmed) {
                      $('#updateForm').submit();
                  }
              })
        });
	
        const empPhone1 = /^[0-9]{3}$/;
        $('#empPhone1').blur(function(){
			if(tagExp.test($('.price').val())){
				Swal.fire({
                    icon: 'error',
                    title: '태그쓰지마세요',
                    text: '',
                }).then(function(){
                	$('#empPhone1').val('');
	    			$('#empPhone1').focus();
                })
			} else if(!priceExp.test($('#empPhone1').val()) && $('#empPhone1').val() != ''){
				Swal.fire({
                    icon: 'error',
                    title: '입력 오류!',
                    text: '숫자만 입력 해 주세요.',
                }).then(function(){
                	$('#empPhone1').val('');
	    			$('#empPhone1').focus();
                })
			}
		});    
   </script>

    <script>    
        /* 사번으로 이미지 불러오기 */
        var empNo = "[[${emp.empNo}]]";
        console.log(empNo);
        $('#test1').val(empNo);
        /* var a = $('#test1').val();
        console.log(a); */
        
        var empNo = "[[${emp.empNo}]]";
        console.log(empNo);
        $('#test2').val(empNo);
        /* var a = $('#test2').val();
        console.log(a); */
        
      </script> 
   </body>
</html>
